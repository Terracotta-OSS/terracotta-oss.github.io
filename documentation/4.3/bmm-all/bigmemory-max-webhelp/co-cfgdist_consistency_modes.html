<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Consistency Modes</title><link rel="Prev" href="co-cfgdist_copy_on_read.html" title="Previous"><link rel="Next" href="co-cfgdist_configuring_robust_data_sets.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-cfgdist_consistency_modes.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="poDTtmjnWQy_002feLN4_002f_002bBbcNA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-cfgdist_consistency_modes.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_product_documentation.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_max_config_guide.html#wwconnect_header">BigMemory Max Configuration Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-cfgdist_defining_distributed_configurations.html#wwconnect_header">Defining a Distributed Configuration</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Consistency Modes</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_17_10_17_20_1" class="Heading_3">Consistency Modes</div><div id="ww3_17_10_17_20_3_2" class="Body">Cache consistency modes are configuration settings and API methods that control the behavior of clustered caches with respect to balancing data consistency and application performance. A cache can be in one of the following consistency modes:</div><div id="ww3_17_10_17_20_3_4_2_3" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Strong</span> – This mode ensures that data in the cache remains consistent across the cluster at all times. It guarantees that a read gets an updated value only after all write operations to that value are completed, and that each put operation is in a separate transaction. The use of locking and transaction acknowledgments maximizes consistency at <span class="emphasis">a potentially substantial cost in performance</span>. This mode is set using the Ehcache configuration file and cannot be changed programmatically (see the <span class="parmname">consistency</span> attribute in <span class="parmname">&lt;terracotta&gt;</span> element).</div><div id="ww3_17_10_17_20_3_4_4_3" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Eventual</span> – This mode guarantees that data in the cache will eventually be consistent. Read/write performance is substantially boosted at the cost of potentially having an inconsistent cache for brief periods of time. This mode is set using the Ehcache configuration file and cannot be changed programmatically (see the <span class="parmname">consistency</span> attribute in <span class="parmname">&lt;terracotta&gt;</span> element).</div><div id="ww3_17_10_17_20_3_6" class="Body">To optimize consistency and performance, consider using eventually consistent caches while selectively using appropriate locking in your application where cluster-wide consistency is critical at all times. Eventual cache operations that are explicitly locked become strongly consistent with respect to each other (but not with respect to non locked operations). For example, a reservation system could be designed with an eventual cache that is only explicitly locked when a customer starts to make a reservation; with this design, eventually consistent data would be available during a customer's search, but during the reservation process, reads and writes would be strongly consistent.</div><div id="ww3_17_10_17_20_3_8_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Bulk Load</span> – This mode is optimized for bulk-loading data into the cache without the slowness introduced by locks or regular eviction. It is similar to the eventual mode, but has batching, higher write speeds, and weaker consistency guarantees. This mode is set using the bulk-load API only. For information, see "Bulk Loading" in the <span class="Citation">Developer Guide</span> for BigMemory Max. When turned off, allows the configured consistency mode (either strong or eventual) to take effect again.</div><div id="ww3_17_10_17_20_3_10" class="Body">Use configuration to set the permanent consistency mode for a cache as required for your application, and the bulk-load mode only during the time when populating (warming) or refreshing the cache.</div><div id="ww3_17_10_17_20_3_12_2" class="Section_Title">APIs Related to Consistency</div><div id="ww3_17_10_17_20_3_12_4" class="Body">The following APIs and settings also affect consistency:</div><div id="ww3_17_10_17_20_3_12_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Explicit Locking</span> – This API provides methods for cluster-wide (application-level) locking on specific elements in a cache. There is guaranteed consistency across the cluster at all times for operations on elements covered by a lock. When used with the strong consistency mode in a cache, <span class="emphasis">each cache operation</span> is committed in a single transaction. When used with the eventual consistency mode in a cache, <span class="emphasis">all cache operations covered by an explicit lock</span> are committed in a single transaction. While explicit locking of elements provides fine-grained locking, there is still the potential for contention, blocked threads, and increased performance overhead from managing clustered locks. For information, see "Explicit Locking" in the <span class="Citation">Developer Guide</span> for BigMemory Max.</div><div id="ww3_17_10_17_20_3_12_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Bulk-loading methods</span> – Bulk-loading Cache methods putAll(), getAll(), and removeAll() provide high-performance and eventual consistency. These can also be used with strong consistency. If you can use them, it's unnecessary to use bulk-load mode.</div><div id="ww3_17_10_17_20_3_12_6_6_3" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="inlinetitle">Atomic methods</span> – To guarantee write consistency at all times and avoid potential race conditions for put operations, use atomic methods. The following Compare and Swap (CAS) operations are available:</div><div id="ww3_17_10_17_20_3_12_6_6_5_2" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cache.replace(Element old, Element new)</span> — Conditionally replaces the specified key's old value with the new value, if the currently existing value matches the old value.</div><div id="ww3_17_10_17_20_3_12_6_6_5_4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cache.replace(Element)</span> — Maps the specified key to the specified value, if the key is currently mapped to some value.</div><div id="ww3_17_10_17_20_3_12_6_6_5_6" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cache.putIfAbsent(Element)</span> — Puts the specified key/value pair into the cache only if the key has no currently assigned value. Unlike <span class="codeph">put</span>, which can replace an existing key/value pair, <span class="codeph">putIfAbsent</span> creates the key/value pair only if it is not present in the cache.</div><div id="ww3_17_10_17_20_3_12_6_6_5_8_3" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cache.removeElement(Element)</span> — Conditionally removes the specified key, if it is mapped to the specified value.</div><div id="ww3_17_10_17_20_3_12_8" class="Body">Normally, these methods are used with strong consistency. Unless the property <span class="codeph">org.terracotta.clusteredStore.eventual.cas.enabled</span> is set to "true", these methods throw an UnsupportedOperationException if used with eventual consistency since a race condition cannot be prevented. Other ways to guarantee the return value in eventual consistency are to use the cache decorator StronglyConsistentCacheAccessor, or to use explicit locking. The StronglyConsistentCacheAccessor will use locks with its special substituted versions of the atomic methods. Note that using locks may impact performance. For information about cache decorators and explicit locking, see "Cache Decorators" and "Explicit Locking" in the <span class="Citation">Developer Guide for BigMemory Max</span>.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>