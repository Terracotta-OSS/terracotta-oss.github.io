<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Example: Nonstop/Rejoin</title><link rel="Prev" href="co-samples_search.html" title="Previous"><link rel="Next" href="co-samples__arc.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-samples_nonstop_rejoin.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pDMXgS96nAhpjxVQg_002biryUw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-samples_nonstop_rejoin.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_max_code_samples.html#wwconnect_header">Code Samples</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Example: Nonstop/Rejoin</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_15_16_1" class="Heading_1">Example: Nonstop/Rejoin</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_15_16_2_2_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_15_16_2_2_1_3_1_2" class="Table_Cell">The following description focuses on code snippets from the full code example, which is available at the /code-samples/src/ location in the installed product kit.</div></td></tr></table></div><div id="ww3_15_16_2_4" class="Body">The nonstop feature allows certain operations to proceed on clients that have become disconnected from the cluster, and it allows operations to proceed even if they cannot complete by the nonstop timeout value. The rejoin feature then allows clients to identify a source of Terracotta configuration, so that clients can rejoin a cluster after having been either disconnected from that cluster or timed out by a Terracotta Server.</div><div id="ww3_15_16_2_6" class="Body">This example demonstrates the nonstop and rejoin features of BigMemory Max. After loading the configuration below, use the scripts provided to start and run the server. Then stop the server and verify that the nonstop feature is working. Start the server again and watch the rejoin feature in action.</div><div id="ww3_15_16_2_8" class="Preformatted">Configuration managerConfig = new Configuration() <br>    .terracotta(new TerracottaClientConfiguration().url("localhost:9510").rejoin(true)) <br>    .cache(new CacheConfiguration().name("nonstop-sample") <br>        .persistence(new PersistenceConfiguration().strategy(DISTRIBUTED)) <br>        .maxBytesLocalHeap(128, MemoryUnit.MEGABYTES) <br>        .maxBytesLocalOffHeap(1, MemoryUnit.GIGABYTES) <br>        .terracotta(new TerracottaConfiguration() <br>        .nonstop(new NonstopConfiguration() <br>        .immediateTimeout(false) <br>            .timeoutMillis(10000).enabled(true) <br>        ) <br>        )); <br>CacheManager manager = CacheManager.create(managerConfig); <br>Ehcache bigMemory = manager.getEhcache("nonstop-sample"); <br>try { <br>  System.out.println("**** Put key 1 / value timDoe. ****"); <br>  final Person timDoe = new Person("Tim Doe", 35, Person.Gender.MALE, <br>      "eck street", "San Mateo", "CA"); <br>  bigMemory.put(new Element("1", timDoe)); <br>  System.out.println("**** Get key 1 / value timDoe. ****"); <br>  System.out.println(bigMemory.get("1")); <br>  waitForInput(); <br>  System.out <br>      .println("**** Now you have to kill the server using the <br>       stop-sample-server.bat on Windows or stop-sample-server.sh otherwise ****"); <br>  try { <br>    while (true) { <br>      bigMemory.get("1"); <br>    } <br>  } catch (NonStopCacheException e) { <br>    System.out <br>        .println("**** Server is unreachable - NonStopException received when trying <br>        to do a get on the server. NonStop is working ****"); <br>  } <br>  System.out <br>      .println("**** Now you have to restart the server using the start-sample-server.bat <br>      on Windows or start-sample-server.sh otherwise ****"); <br>  boolean serverStart = false; <br>  while (serverStart  == false) { <br>    try { <br>      bigMemory.get("1"); <br>      //if server is unreachable, exception is thrown when doing the get <br>      serverStart = true; <br>    } catch (NonStopCacheException e) { <br>    } <br>  } <br>  System.out <br>      .println("**** Server is reachable - No More NonStopException received when <br>      trying to do a get on the server. Rejoin is working ****"); <br>} finally <br>{ <br>  if (manager != null) manager.shutdown(); <br>}</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>