<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Configuration, Development and Operations Questions</title><link rel="Prev" href="co-faq_bigmem_max_general_questions.html" title="Previous"><link rel="Next" href="co-faq_bigmem_max_env_interop_questions.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-faq_bigmem_max_config_dev_oper_questionds.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pylfD4yZnOxmvscpzsHNNug" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-faq_bigmem_max_config_dev_oper_questionds.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_max_faq.html#wwconnect_header">FAQ</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Configuration, Development and Operations Questions</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_25_8_1" class="Heading_1">Configuration, Development and Operations Questions</div><div id="ww3_25_8_2_2_2" class="Section_Title">How do I enable restartable mode?</div><div id="ww3_25_8_2_2_4" class="Body">In the servers section of your tc-config.xml, include the following configurations:</div><div id="ww3_25_8_2_2_6" class="Preformatted">&lt;servers&gt; <br>   &lt;server host="host1" name="Server1"&gt; <br>       &lt;data-backup&gt;path/to/my/backup/directory&lt;/data-backup&gt; <br>   &lt;/server&gt; <br>   &lt;restartable enabled="true"/&gt; <br>&lt;/servers&gt;</div><div id="ww3_25_8_2_2_8" class="Body">If persistence of shared data is not required across restarts, set <span class="codeph">&lt;restartable enabled&gt;</span> to "false".</div><div id="ww3_25_8_2_4_2" class="Section_Title">How do I configure failover to work properly with two Terracotta servers?</div><div id="ww3_25_8_2_4_4" class="Body">Configure both servers in the <span class="codeph">&lt;servers&gt;</span> section of the Terracotta configuration file. Start the two Terracotta server instances that use that configuration file, one server assumes control of the cluster (the ACTIVE) and the second becomes the mirror (the PASSIVE). For more information, see <span class="xref"><a href="../bigmemory-max-webhelp/to-abt_about_high_availability.html#wwconnect_header" title="About High Availability">Configuring a Terracotta Cluster for High Availability</a></span>.</div><div id="ww3_25_8_2_6_2" class="Section_Title">How do I know that my application has started up with a Terracotta client and is sharing data?</div><div id="ww3_25_8_2_6_4" class="Body">The Terracotta Management Console (TMC) displays cluster topology by listing Terracotta server groups and connected client nodes in a navigation tree. For more information, see the <span class="Citation">Terracotta Management Console User Guide</span>.</div><div id="ww3_25_8_2_6_6" class="Body">In addition, check standard output for messages that the Terracotta client has started up without errors. Terracotta clients also log messages to a file specified in the <span class="codeph">&lt;clients&gt;</span> section of the tc-config file.</div><div id="ww3_25_8_2_8_2" class="Section_Title">Is there a maximum number of objects that can be held by one Terracotta server instance?</div><div id="ww3_25_8_2_8_4" class="Body">The number of objects that can be held by a Terracotta server instance is two billion, a limit imposed by the design of Java collections. It is unlikely that a Terracotta cluster will need to approach even 50 percent of that maximum. However, if it does, other issues may arise that require the rearchitecting of how application data is handled in the cluster.</div><div id="ww3_25_8_2_10_2" class="Section_Title">How many Terracotta clients (L1s) can connect to the Terracotta Server Array (L2s) in a cluster?</div><div id="ww3_25_8_2_10_4" class="Body">While the number of L1s that can exist in a Terracotta cluster is theoretically unbounded (and cannot be configured), effectively planning for resource limitations and the size of the shared data set should yield an optimum number. Typically, the most important factors that will impact that number are the requirements for performance and availability. Typical questions when sizing a cluster:</div><div id="ww3_25_8_2_10_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>What is the desired transactions-per-second?</div><div id="ww3_25_8_2_10_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>What are the failover scenarios?</div><div id="ww3_25_8_2_10_6_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>How fast and reliable is the network and hardware? How much memory and disk space will each machine have?</div><div id="ww3_25_8_2_10_6_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>How much shared data is going to be stored in the cluster? How much of that data should be on the L1s? Will BigMemory be used?</div><div id="ww3_25_8_2_10_6_10" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>How many stripes (active Terracotta servers) does the cluster have?</div><div id="ww3_25_8_2_10_6_12" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>How much load will there be on the L1s? On the L2s?</div><div id="ww3_25_8_2_10_8" class="Body">The most important method for determining the optimum size of a cluster is to test various cluster configurations under load and observe how well each setup meets overall requirements.</div><div id="ww3_25_8_2_12_2" class="Section_Title">What's the best way for my application to listen to Terracotta cluster events such as lost application nodes?</div><div id="ww3_25_8_2_12_4" class="Body">If you are using Ehcache, use the cluster-events Ehcache API.</div><div id="ww3_25_8_2_14_2" class="Section_Title">How can my application check that the Terracotta process is alive at runtime?</div><div id="ww3_25_8_2_14_4" class="Body">Your application can check to see if the system property tc.active is true. For example, the following line of code would return true if Terracotta is active at the time it is run:</div><div id="ww3_25_8_2_14_6" class="Preformatted">Boolean.getBoolean("tc.active");</div><div id="ww3_25_8_2_16_2" class="Section_Title">How do I confirm that my Terracotta servers are up and running correctly?</div><div id="ww3_25_8_2_16_4" class="Body">Here are some ways to confirm that your Terracotta servers are running:</div><div id="ww3_25_8_2_16_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Connect to the servers using the Terracotta Management Console (see the <span class="Citation">Terracotta Management Console User Guide</span>).</div><div id="ww3_25_8_2_16_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Check the standard output messages to see that each server started without errors.</div><div id="ww3_25_8_2_16_6_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Check each server's logs to see that each server started without errors. The location of server logs is specified in <span class="filepath">tc-config.xml</span>.</div><div id="ww3_25_8_2_16_6_8" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Use the Terracotta script <span class="filepath">server-stat.sh</span> or <span class="filepath">server-stat.bat</span> to generate a short status report on one or more Terracotta servers.</div><div id="ww3_25_8_2_16_6_10" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Use a tool such as <span class="xref"><a href="http://www.gnu.org/software/wget/" target="external_window">wget</a></span> to access the /config or /version servlet. For example, for a server running on localhost and port 9889, use the following wget command to connect to the version servlet:</div><div id="ww3_25_8_2_16_6_10_5" class="Preformatted_1">[PROMPT] wget http://localhost:9889/version</div><div id="ww3_25_8_2_18_2" class="Section_Title">Are there ways I can monitor the cluster that don't involve using the Terracotta Management Console?</div><div id="ww3_25_8_2_18_4" class="Body">You can use the REST API (see the Terracotta REST API Developer Guide) or the monitoring feature provided by WAN Replication Service (see the <span class="Citation">WAN Replication User Guide</span>).</div><div id="ww3_25_8_2_20_2" class="Section_Title">How can I control the logging level for Terracotta servers and clients?</div><div id="ww3_25_8_2_20_4" class="Body">Create a file called <span class="filepath">.tc.custom.log4j.properties</span> and edit it as a standard <span class="filepath">log4j.properties</span> file to configure logging, including level, for the Terracotta node that loads it. This file is searched for in the path specified by the environment variable TC_INSTALL_DIR as defined in the start-server script when running a server, or if user defined when running a client.</div><div id="ww3_25_8_2_22_2" class="Section_Title">Why is it a bad idea to change shared data in a shutdown hook?</div><div id="ww3_25_8_2_22_4" class="Body">If a node attempts to change shared data while exiting, and the shutdown thread blocks, the node may hang and be dropped from the cluster, failing to exit as planned. The thread may block for any number of reasons, such as the failure to obtain a lock. A better alternative is to use the cluster events API to have a second node (one that is not exiting) execute certain code when it detects that the first node is exiting. If you are using Ehcache, use the cluster-events Ehcache API.</div><div id="ww3_25_8_2_22_6" class="Body">You can call <span class="apiname">org.terracotta.api.Terracotta.registerBeforeShutdownHook(Runnable beforeShutDownHook)</span> to perform various cleanup tasks before the Terracotta client disconnects and shuts down.</div><div id="ww3_25_8_2_22_8" class="Body">Note that a Terracotta client is not required to release locks before shutting down. The Terracotta server will reclaim those locks, although any outstanding transactions are not committed.</div><div id="ww3_25_8_2_24_2" class="Section_Title">Can I store collections inside collections that are stored as values in a cache?</div><div id="ww3_25_8_2_24_4" class="Body">This is not recommended unless your application logic takes careful account of how such values can be modified safely. Race conditions, undefined results, ConcurrentModificationException, and other problems can arise.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>