<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Connecting via JMX</title><link rel="Prev" href="co-monitor_overview_monitoring_wan_replication.html" title="Previous"><link rel="Next" href="co-monitor_connecting_via_rest_api.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-monitor_connecting_via_jmx.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pJorUycc1XpK74yIlLpGGjA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-monitor_connecting_via_jmx.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_component_documentation.html#wwconnect_header">Component Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_wan_replication_guide.html#wwconnect_header">WAN Replication User Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-monitor_monitoring_and_managing_wan.html#wwconnect_header">Monitoring and Managing WAN Replication</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Connecting via JMX</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_21_10_17_8_1" class="Heading_3">Connecting via JMX</div><div id="ww3_21_10_17_8_3_2" class="Body">This section describes how to:</div><div id="ww3_21_10_17_8_3_4_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="xref"><a href="../bigmemory-max-webhelp/co-monitor_connecting_via_jmx.html#wwconnect_header" title="Connecting via JMX">Set up to connect via JMX</a></span>.</div><div id="ww3_21_10_17_8_3_4_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="xref"><a href="../bigmemory-max-webhelp/co-monitor_connecting_via_jmx.html#ww3_21_10_17_8_3_8_2" title="Connecting via JMX">Use JMX MBeans to display statistics in your JMX monitoring application</a></span>.</div><div id="ww3_21_10_17_8_3_4_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="xref"><a href="../bigmemory-max-webhelp/co-monitor_connecting_via_jmx.html#ww3_21_10_17_8_3_14_2" title="Connecting via JMX">Programmatically access the statistics through JMX</a></span> if you have configured your Orchestrator process to listen for JMX via RMI.</div><div id="ww3_21_10_17_8_3_6_2" class="Section_Title">Setting up to Connect via JMX</div><div id="ww3_21_10_17_8_3_6_4" class="Body">You can access the statistics through JMX in either of the following ways:</div><div id="ww3_21_10_17_8_3_6_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Via RMI on the Orchestrator process.</div><div id="ww3_21_10_17_8_3_6_6_2_3" class="List_1_Continued">To set up JMX to listen through RMI on the Orchestrator process, add the following arguments to the JAVA_OPTS environment variable before executing <span class="codeph">start-wan.sh</span> :</div><div id="ww3_21_10_17_8_3_6_6_2_5" class="Preformatted_1">JAVA_OPTS="-Dcom.sun.management.jmxremote.port=&lt;number&gt; <br>-Dcom.sun.management.jmxremote.authenticate=false <br>-Dcom.sun.management.jmxremote.ssl=false"<br></div><div class="ww_skin_page_overflow"><table class="note2" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_21_10_17_8_3_6_6_2_7_1_3_1_2_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_21_10_17_8_3_6_6_2_7_1_3_1_3" class="Table_Cell">Any additional Orchestrator process started on the same machine will fail with an "Address is in use" error if the JAVA_ OPTS environment variable is still visible. Thus JAVA_ OPTS should be set inside the script that starts the process, or else the port number should be changed.</div></td></tr></table></div><div id="ww3_21_10_17_8_3_6_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>By communicating with the Orchestrator process directly. Simply start your WAN Region and connect your monitoring application to the Orchestrator process.</div><div id="ww3_21_10_17_8_3_8_2" class="Section_Title">Using JMX Beans to Display Statistics</div><div id="ww3_21_10_17_8_3_8_4" class="Body">The Orchestrators expose one MBean for each cache and one MBean for each replica. Once connected to an Orchestrator process via JMX, you can use the Terracotta WAN-specific MBeans within the org.terracotta.wan domain to display statistics about:</div><div id="ww3_21_10_17_8_3_8_6_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>The overall state of the master cache and its replicas.</div><div id="ww3_21_10_17_8_3_8_6_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>A particular replica cache.</div><div id="ww3_21_10_17_8_3_10_2" class="Section_Title">Displaying the Overall Statistics for a Cache and its Replicas</div><div id="ww3_21_10_17_8_3_10_4" class="Body">Use the following ObjectName form to display the overall statistics for a master cache and its replicas:</div><div id="ww3_21_10_17_8_3_10_6" class="Preformatted">org.terracotta.wan:type=WAN,cacheManager="<span class="varname">&lt;name&gt;</span>",cache="<span class="varname">&lt;name&gt;</span>"</div><div id="ww3_21_10_17_8_3_10_8" class="Body">where:</div><div id="ww3_21_10_17_8_3_10_10_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cacheManager</span> specifies the name of the cache's cache manager, enclosed in quotation marks.</div><div id="ww3_21_10_17_8_3_10_10_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">cache</span> specifies the name of the cache, enclosed in quotation marks.</div><div id="ww3_21_10_17_8_3_10_12" class="Body">For example:</div><div id="ww3_21_10_17_8_3_10_14" class="Body">The following ObjectName displays the overall cache-wide statistics for the cache <span class="codeph">"test-cache-1"</span> in the cacheManager <span class="codeph">"test"</span>.</div><div id="ww3_21_10_17_8_3_10_16" class="Preformatted">org.terracotta.wan:type=WAN,cacheManager="test",cache="test-cache-1"</div><div id="ww3_21_10_17_8_3_12_2" class="Section_Title">Displaying Statistics for a Particular Replica</div><div id="ww3_21_10_17_8_3_12_4" class="Body">To display only the statistics for a particular replica of the cache, append replica=&lt;host_port&gt; to the ObjectName, as follows:</div><div id="ww3_21_10_17_8_3_12_6" class="Preformatted">org.terracotta.wan:type=WAN,cacheManager="&lt;name&gt;",cache="&lt;name&gt;",replica=&lt;host_port&gt;</div><div id="ww3_21_10_17_8_3_12_8" class="Body">where <span class="var-in-codeph">&lt;host_port&gt;</span> specifies the host name and port of the replica. For example, <span class="codeph">myhost_1234</span>. Do not enclose the value in quotation marks.</div><div id="ww3_21_10_17_8_3_12_10" class="Body">For example:</div><div id="ww3_21_10_17_8_3_12_12" class="Body">The following ObjectName displays statistics only for the cache's replica which has the hostname <span class="codeph">myhost</span> and listens on port <span class="codeph">1234</span> (as configured in the wan.xml for the replica).</div><div id="ww3_21_10_17_8_3_12_14" class="Preformatted">org.terracotta.wan:type=WAN,cacheManager="test",cache="test-cache-1",<br>replica=myhost_1234</div><div id="ww3_21_10_17_8_3_14_2" class="Section_Title">Programmatic Access through JMX via RMI</div><div id="ww3_21_10_17_8_3_14_4" class="Body">As a convenience, some classes have been added for programmatic access to the remote statistics. If you have configured your Orchestrator process to listen for JMX via RMI, you may use the RMIStatisticConnection class. In this example the Orchestrator is running on <span class="codeph">"localhost"</span>, with an RMI port of <span class="codeph">9999</span>. The cache to connect to is <span class="codeph">"test-cache-1"</span> in the <span class="codeph">"test"</span> cache manager, as in previous examples.</div><div id="ww3_21_10_17_8_3_14_6" class="Preformatted">// Create the connection<br>StatisticConnection rmiStatisticConnection = new RMIStatisticConnection(<br>    "localhost", 9999, "test", "test-cache-1");<br><br>// Get a statistic<br>Gauge&lt;String&gt; g = rmiStatisticConnection.getStatistic(<br>    StatisticName.CONFIG_REPLICATION_MODE);<br><br>// Do something with the statistic<br>System.out.println(g.getValue());<br><br>// Close the connection<br>rmiStatisticsConnection.close();</div><div id="ww3_21_10_17_8_3_14_8" class="Body">For gauges whose values are non-numeric, calling the getValue() method again will fetch the latest value (i.e., you can call it in a loop and expect the value to change). The statistics client classes are inside wan-core.jar. In order to use it, pull in wan-core.jar as a Terracotta Maven Plugin dependency.</div><div id="ww3_21_10_17_8_3_14_10" class="Body">For gauges whose values are numeric, you can expect getValue() to eventually return the most recent value, but with a certain delay, depending on your cluster's configuration. For example, your implementation might throttle value updates; by default, the value is cached for 10 seconds, no matter how many actual updates take place during that interval.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>