<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>.NET Client Serialization</title><link rel="Prev" href="co-dot_consistency.html" title="Previous"><link rel="Next" href="co-dot_client_demo_samples.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-dot_client_serialization.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN6YUXPHjGocJqGNL_002f3Gl7jw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-dot_client_serialization.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_component_documentation.html#wwconnect_header">Component Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_ccl_user_guide.html#wwconnect_header">Cross-Language Clients User Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-dot_dot_net_clients.html#wwconnect_header">BigMemory .NET Client</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">.NET Client Serialization</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_21_12_9_18_1" class="Heading_3">.NET Client Serialization</div><div id="ww3_21_12_9_18_3_2_2" class="Section_Title">Cross-Language Serialization</div><div id="ww3_21_12_9_18_3_2_4" class="Body">Data that will be shared across languages needs to be serialized. The choice of which serializer to use depends upon your environment. Some planning and consideration needs to go into the choice of a serializer, as there are pros and cons related to each. For example, with a BSON serializer, you can manually annotate the domain object for desired attributes. On the other hand, a Google Protocol Buffer serializer can automatically generate the domain object with the annotation for the serializer for you, however, if you have an existing domain object, then using the automatic generation can be intrusive.</div><div id="ww3_21_12_9_18_3_2_6" class="Body">Your serializer/deserializer class should include the following:</div><div id="ww3_21_12_9_18_3_2_8_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>A list of all the namespaces/packages that will be used.</div><div id="ww3_21_12_9_18_3_2_8_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>A class definition consisting of the following methods/functions:</div><div id="ww3_21_12_9_18_3_2_8_4_3_2" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>serializeKey() - accepts the key and returns the platform-neutral format (PNF) Value</div><div id="ww3_21_12_9_18_3_2_8_4_3_4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>deserializeKey() - accepts the PNF Value and returns the key</div><div id="ww3_21_12_9_18_3_2_8_4_3_6" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>serializeValue() - accepts the object value and returns the PNF StoredValue</div><div id="ww3_21_12_9_18_3_2_8_4_3_8" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>deserializeValue() - accepts the PNF StoredValue and returns the object value</div><div id="ww3_21_12_9_18_3_4_2" class="Section_Title">Example BSON serializer</div><div id="ww3_21_12_9_18_3_4_4" class="Preformatted">using Newtonsoft.Json;<br>using Newtonsoft.Json.Bson;<br>using Newtonsoft.Json.Converters;<br>using Newtonsoft.Json.Linq;<br>using System;<br>using System.Collections.Generic;<br>using System.IO;<br>using System.Text;<br>using Terracotta.Ehcache;<br>using Terracotta.Ehcache.Thrift;</div><div id="ww3_21_12_9_18_3_4_5" class="Section_Division">Class definition: serializeKey()</div><div id="ww3_21_12_9_18_3_4_5_2" class="Preformatted">public Terracotta.Ehcache.Thrift.Value serializeKey(string key)<br><br>    {<br><br>        return ValueHelper.newValue(key);<br>    } </div><div id="ww3_21_12_9_18_3_4_6" class="Section_Division">Class definition: deserializeKey()</div><div id="ww3_21_12_9_18_3_4_6_2" class="Preformatted">public string deserializeKey(Terracotta.Ehcache. Thrift.Value serializedKey)<br><br> {<br><br>  return (string)ValueHelper.findSetValue  (serializedKey);<br> }</div><div id="ww3_21_12_9_18_3_4_8" class="Section_Division">Class definition: serializeValue()</div><div id="ww3_21_12_9_18_3_4_8_2" class="Preformatted">public StoredValue serializeValue(Recipe2 objectValue)<br><br> {<br><br>  MemoryStream ms = new MemoryStream();<br><br>// serialize recipe to BSON      <br><br>  BsonWriter writer = new BsonWriter(ms);      <br><br>  JsonSerializer serializer = new JsonSerializer();<br><br>  serializer.Serialize(writer, objectValue);<br><br>  byte[] barray = ms.ToArray();<br><br>  Dictionary&lt;String, Object&gt; nvPairs = new  Dictionary&lt;String, Object&gt;();<br><br>// two indexable attributes<br><br>  nvPairs["name"] = objectValue.Name;<br><br>  nvPairs["bakingTime"] = objectValue.BakingTime;<br><br>// ship the bson version of the recipe as a byte array<br><br>   return ValueHelper.nullSafeStoredValue(barray, nvPairs);<br>}</div><div id="ww3_21_12_9_18_3_4_10" class="Section_Division">Class definition: deserializeValue()</div><div id="ww3_21_12_9_18_3_4_10_2" class="Preformatted">public Recipe2 deserializeValue  (Terracotta.Ehcache.Thrift.StoredValue value)<br><br> {<br><br>  MemoryStream ms = new MemoryStream(value.Value. BinaryValue);<br><br>  ms.Seek(0, SeekOrigin.Begin);           <br><br>  BsonReader reader = new BsonReader(ms);           <br><br>  JsonSerializer serializer = new JsonSerializer();<br><br>  Recipe2 recipe = serializer.Deserialize &lt;Recipe2&gt;(reader);<br><br>  return recipe;<br> } </div><div id="ww3_21_12_9_18_3_6_2" class="Section_Title">Example Google Protocol Buffer Serializer</div><div id="ww3_21_12_9_18_3_6_4" class="Preformatted">using System;<br>using System.Collections.Generic;<br>using System.IO;<br>using System.Text;<br>using Terracotta.Ehcache;<br>using Terracotta.Ehcache.Thrift;</div><div id="ww3_21_12_9_18_3_6_5" class="Section_Division">Class definition: serializeKey()</div><div id="ww3_21_12_9_18_3_6_5_2" class="Preformatted">public Value serializeKey(string key)                                         <br><br>    {<br><br>            Value val = new Value();<br><br>             val.StringValue = key;<br><br>             return val;<br>    }</div><div id="ww3_21_12_9_18_3_6_7" class="Section_Division">Class definition: deserializeKey()</div><div id="ww3_21_12_9_18_3_6_7_2" class="Preformatted">public string deserializeKey(Value serializedKey)<br><br>    {<br><br>        return serializedKey.StringValue;<br><br><br>    }</div><div id="ww3_21_12_9_18_3_6_9" class="Section_Division">Class definition: serializeValue()</div><div id="ww3_21_12_9_18_3_6_9_2" class="Preformatted">public StoredValue serializeValue(RecipeProject.RecipeStructure objectValue)<br><br> {<br><br>   Dictionary&lt;String, Object&gt; nvPairs = new<br><br>   Dictionary&lt;String, Object&gt;();<br><br>   nvPairs.Add(KEY_NAME, objectValue.name);<br><br>   MemoryStream ms = new MemoryStream();<br><br>   ProtoBuf.Serializer.Serialize&lt;RecipeProject.<br><br>   RecipeStructure&gt;(ms,objectValue);<br><br>   return ValueHelper.nullSafeStoredValue(ms.ToArray(), nvPairs);<br> }</div><div id="ww3_21_12_9_18_3_6_11" class="Section_Division">Class definition: deserializeValue()</div><div id="ww3_21_12_9_18_3_6_11_2" class="Preformatted">public RecipeProject.RecipeStructure deserializeValue (StoredValue value)<br><br> {<br><br>   MemoryStream ms = new MemoryStream(value.Value.BinaryValue);<br><br>   return ProtoBuf.Serializer.Deserialize&lt;RecipeProject. RecipeStructure&gt;(ms);<br><br><br>  }</div><div id="ww3_21_12_9_18_3_8_2" class="Section_Title">Single-Language Serialization</div><div id="ww3_21_12_9_18_3_8_4" class="Body">For single-language use cases, it is not necessary to create a serializer/deserializer class. Leverage .NET's native binary serialization by including the provided CSharpNativeSerializer class in cache operations. For example:</div><div id="ww3_21_12_9_18_3_8_6" class="Preformatted">ICachemanager manager = XPlatform.CreateCacheManager(...);<br>ICache cache&lt;string,string&gt; = manage.GetCache("cachename", <br>    new CSharpNativeSerializer&lt;string,string&gt;())</div><div id="ww3_21_12_9_18_3_8_8" class="Body">API documentation for the <span class="apiname">CSharpNativeSerializer</span> is available in the<span class="filepath"> /apis/csharp/apidoc/</span> directory of the kit. For more information about .NET native serialization, refer to <span class="external"><a href="http://msdn.microsoft.com/en-us/library/7ay27kt9%28v=vs.90%29.aspx" target="external_window">http://msdn.microsoft.com/en-us/library/7ay27kt9%28v=vs.90%29.aspx</a></span>. </div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>