<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Installing Maintenance Version Upgrades for 4.2</title><link rel="Prev" href="co-fix_prepare_for_maintenance_version_upgrades.html" title="Previous"><link rel="Next" href="co-fix_revert_tsa_to_previous_version.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-fix_install_maintenance_version_upgrades.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN0kjWYiF3gf4bY3Rw_002bBiAHg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-fix_install_maintenance_version_upgrades.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_upgrade_guide.html#wwconnect_header">Upgrade and Migration Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-fix_install_maintenance_version_upgrades.html#wwconnect_header">Installing Maintenance Version Upgrades for 4.2</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Installing Maintenance Version Upgrades for 4.2</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_11_11_9_1" class="Heading_2">Installing Maintenance Version Upgrades for 4.2</div><div id="ww3_11_11_9_2_2" class="Body">Use the following procedure to upgrade BigMemory Max from 4.2.x to 4.2.y.</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_11_11_9_2_4_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_11_11_9_2_4_1_3_1_2" class="Table_Cell">This procedure assumes you are currently running a version 4.2 cluster in a high availability deployment configuration. In a cluster without any mirror servers, downtime is unavoidable during an upgrade installation. Additionally, if a cluster without mirrors is a non-persistent cluster, servers cannot be upgraded without losing all the data.</div></td></tr></table></div><div id="ww3_11_11_9_2_6_2" class="Section_Title">Step 1: Download the Kit</div><div id="ww3_11_11_9_2_6_4" class="Body">Download the BigMemory kit and verify that you have the correct license keys for the version you are installing.</div><div id="ww3_11_11_9_2_8_2" class="Section_Title">Step 2: Upgrade All Terracotta Server Arrays (TSAs)</div><div id="ww3_11_11_9_2_8_4" class="Body">You must upgrade all TSAs in all regions before proceeding to Step 3, as follows.</div><div id="ww3_11_11_9_2_8_6_2" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>For each mirror server instance in the cluster, do the following:</div><div id="ww3_11_11_9_2_8_6_2_3_2" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Shut down the mirror server using the <span class="codeph">stop-tc-server</span> script.</div><div id="ww3_11_11_9_2_8_6_2_3_4" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Remove the old version of BigMemory Max from the installation directory of the mirror server.</div><div id="ww3_11_11_9_2_8_6_2_3_6" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Optionally delete the objectdb data that is saved in the server's data directory under <span class="filepath">/dirty-objectdb-backup/dirty-objectdb-&lt;timestamp&gt;</span>. Alternatively, you can restore from the old dirty objectdb's at a later time.</div><div id="ww3_11_11_9_2_8_6_2_3_8" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Unzip the upgrade file in the mirror Terracotta server's installation (root) directory.</div><div id="ww3_11_11_9_2_8_6_2_3_8_3" class="Numbered_2_Continued">On a UNIX/Linux machine, use the tar command. For example:</div><div id="ww3_11_11_9_2_8_6_2_3_8_5" class="Preformatted_2"> tar zxf terracotta-4.2.1.tar.gz</div><div id="ww3_11_11_9_2_8_6_2_3_8_7" class="Numbered_2_Continued">On a Microsoft Windows machine, double-click the zip file.</div><div id="ww3_11_11_9_2_8_6_2_3_10" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Startup the mirror server using the <span class="codeph">start-tc-server</span> script and wait for the synchronization to complete.</div><div id="ww3_11_11_9_2_8_6_2_3_12" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Confirm that the mirror server has synced with the active server. You can use the Terracotta Monitoring Console to monitor server status.</div><div id="ww3_11_11_9_2_8_6_2_3_14" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>Confirm that the upgrade was successful by running the version check shell script. This script is available in&lt;kit&gt;/server/bin/version.sh (or version.bat for Windows) and prints the current kit's version in standard output. For example, this command:</div><div id="ww3_11_11_9_2_8_6_2_3_14_3" class="Preformatted_2"> $ ./version.sh</div><div id="ww3_11_11_9_2_8_6_2_3_14_5" class="Numbered_2_Continued">Might produce this output:</div><div id="ww3_11_11_9_2_8_6_2_3_14_7" class="Preformatted_2">Terracotta Enterprise 4.3.0-SNAPSHOT</div><div id="ww3_11_11_9_2_8_6_4" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>For each active server instance in the cluster, do the following:</div><div id="ww3_11_11_9_2_8_6_4_3_2" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Shut down the active server using the <span class="codeph">stop-tc-server</span> script.</div><div id="ww3_11_11_9_2_8_6_4_3_2_5" class="Numbered_2_Continued">The cluster fails over to the mirror server, which now becomes the active server.</div><div id="ww3_11_11_9_2_8_6_4_3_4" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Install the upgrade on the shut-down server, the same way you installed it on the mirror server.</div><div id="ww3_11_11_9_2_8_6_4_3_6" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Startup the server using the start-tc-server script. The formerly active server now becomes the mirror server.</div><div id="ww3_11_11_9_2_8_6_4_3_8" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Optionally perform a failback to make the original active server (which is now a mirror) become the active server again. Alternatively, you can just leave it the way it is (i.e., the original active is now a mirror, and the original mirror is now an active.</div><div id="ww3_11_11_9_2_8_6_4_3_8_3" class="Numbered_2_Continued">To perform a failback, stop the currently active server (i.e., the original mirror server). This will cause the original active server to become the active server again. Then restart the original mirror server, which will act as a mirror server again. Lastly, confirm that the original mirror server has synced with the newly active server. You can use the Terracotta Monitoring Console to monitor server status.</div><div id="ww3_11_11_9_2_8_6_6" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>For each client in the cluster, do the following:</div><div id="ww3_11_11_9_2_8_6_6_3_2" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Shut down the client. A Terracotta client will shut down when you shut down your application.</div><div id="ww3_11_11_9_2_8_6_6_3_4" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Upgrade the software on the client.</div><div id="ww3_11_11_9_2_8_6_6_3_6" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Startup the client.</div><div id="ww3_11_11_9_2_8_8" class="Body">To check the current versions of your cluster's nodes, the Terracotta Management Console (TMC) provides a Check Version button. For details, see the <span class="Citation">Terracotta Management Console User's Guide</span>. </div><div id="ww3_11_11_9_2_10_2" class="Section_Title">Step 3: Stop All Orchestrators</div><div id="ww3_11_11_9_2_10_4" class="Body">Perform this step if your cluster includes the BigMemory WAN Replication service. Stop all Orchestrators by running the <span class="codeph">stop-wan.sh</span> or <span class="codeph">stop-wan.bat</span> script from the kit. For example:</div><div id="ww3_11_11_9_2_10_6" class="Preformatted">&lt;kit&gt;/server/bin/stop-wan.sh -f path/to/wan.xml</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_11_11_9_2_10_8_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_11_11_9_2_10_8_1_3_1_2" class="Table_Cell">If your cluster contains standby Orchestrators that are configured to reconnect the replica caches if they become disconnected from their master caches (i.e., if the Orchestrator's <span class="parmname">replicaDisconnectBehavior</span> parameter is set to <span class="codeph">reconnectResync</span> ), then we recommend stopping the standby Orchestrators first, and then stopping the master Orchestrators.</div></td></tr></table></div><div id="ww3_11_11_9_2_12_2" class="Section_Title">Step 4: Upgrade All Orchestrators to the Same Version</div><div id="ww3_11_11_9_2_12_4" class="Body">Perform this step if your cluster includes the BigMemory WAN Replication service. Install the new Orchestrator version from the latest BigMemory Max kit onto your Orchestrator machines. All Orchestrators must run the same version.</div><div id="ww3_11_11_9_2_14_2" class="Section_Title">Step 5: Restart All Orchestrators</div><div id="ww3_11_11_9_2_14_4" class="Body">Perform this step if your cluster includes the BigMemory WAN Replication service. Restart all Orchestrators with the new version by running the <span class="codeph">start-wan.sh</span> or <span class="codeph">start-wan.bat</span> script from the kit. For example:</div><div id="ww3_11_11_9_2_14_6" class="Preformatted">&lt;kit&gt;/server/bin/start-wan.sh -f path/to/wan.xml</div><div id="ww3_11_11_9_2_14_8" class="Body">The Master region will become immediately available, and then it will resynchronize all Replica regions.</div><div id="ww3_11_11_9_2_14_10" class="Body">Note: The resynchronization process of existing WAN-enabled caches will depend on the value of the replicaDisconnectBehavior configuration parameter. For more information, see "Orchestrator Configuration Parameters in the <span class="Citation">BigMemory WAN Replication User Guide</span>. </div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>