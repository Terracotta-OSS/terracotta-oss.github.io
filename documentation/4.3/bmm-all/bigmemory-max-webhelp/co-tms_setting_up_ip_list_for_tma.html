<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Securing TSA Access using a Permitted IP List</title><link rel="Prev" href="co-tms_setting_up_security_on_tms.html" title="Previous"><link rel="Next" href="co-tms_restricting_clients_to_specified_servers.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-tms_setting_up_ip_list_for_tma.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pXg6k7rOHuE0irrjJnVlNlg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-tms_setting_up_ip_list_for_tma.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_product_documentation.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_max_security_guide.html#wwconnect_header">BigMemory Max Security Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-tms_using_secure_tsa_with_tms.html#wwconnect_header">Setting Up a TSA to Use the Terracotta Management Server</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Securing TSA Access using a Permitted IP List</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_17_14_19_14_1" class="Heading_3">Securing TSA Access using a Permitted IP List</div><div id="ww3_17_14_19_14_3_2" class="Body">The IP white-listing feature enables you as the cluster administrator to ensure that only clients from certain explicitly named IP addresses can access the TSA. You can use this feature, for example, to secure the TSA from malicious clients attempting to connect to the TSA. The term "clients" here refers to caching clients, JMX clients and HTTP clients. The so-called white-list is a list of IPs, and clients running on these IPs are allowed to access the TSA; any client whose IP is not in the white-list will not be allowed to access the TSA. You maintain the white-list of known client IPs in a plain text file. CIDR notations can also be used to cover a range of IPs.</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_14_19_14_3_4_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_14_19_14_3_4_1_3_1_2" class="Table_Cell">It should be understood that usage of this feature (on its own) does not provide a strong level of security for the TSA. Features such as SSL encryption and authentication should be enabled for true security. Additionally, the ideal way to enforce connection restrictions based on IP addresses would be to use host-level firewalls rather than this feature.</div></td></tr></table></div><div id="ww3_17_14_19_14_3_6" class="Body">If you want to use white-listing, you need to enable it at server startup. Once the server has started with white-listing enabled, white-listing cannot be turned back off while the server is running. However, you can change the existing IP/CIDR entries in the white-list file while the server is running. Also you can add and delete entries in the white-list file while the server is running, in order to modify the set of clients that need access to the cluster.</div><div id="ww3_17_14_19_14_3_8" class="Body">If you do not switch on white-listing at server startup, you cannot switch on white-listing while the server is running.</div><div id="ww3_17_14_19_14_3_10" class="Body">In a multi-stripe cluster, you need to start up all servers (both actives and passives) with the same copy of the white-list file, and when there are updates to the white-list file, you need to ensure that the same changes are mirrored across all stripes. Note that the TSA does not do any cross-stripe validation on the contents of the white-list file, so it is your responsibility as the cluster administrator to make sure that this happens.</div><div id="ww3_17_14_19_14_3_12_2" class="Section_Title">Usage</div><div id="ww3_17_14_19_14_3_12_4" class="Body">To enable white-listing, you need to start the server with the following tc-config property set:</div><div id="ww3_17_14_19_14_3_12_6" class="Preformatted">ip.white.list="&lt;location&gt;/&lt;file&gt;"</div><div id="ww3_17_14_19_14_3_12_8" class="Body">where &lt;location&gt; is the path containing the white-list file, and &lt;file&gt; is the name of the white-list file.</div><div id="ww3_17_14_19_14_3_12_10" class="Body">White-listing is enabled/disabled based on the presence of this tc-config property entry. The value of this property is the complete path to the white-list file. If the file is not found at the specified location, the server startup will fail with an appropriate error message. If the file is present but there is an error reading the file, the server startup will continue with white-listing disabled, and the failure will be logged in the server log. If the property is not specified, white-listing is disabled.</div><div id="ww3_17_14_19_14_3_12_12" class="Body">The server IPs specified in the tc-config file of the server are always white-listed. If hostnames are used in the tc-config entries instead of IPs, the server will attempt to resolve these hostnames to IPs. If the resolution fails, server startup will continue with white-listing disabled. So when this IP white-listing feature is used, it is recommended to have only IPs configured for servers in the tc-config file. Similarly, localhost IPs are always white-listed too.</div><div id="ww3_17_14_19_14_3_14_2" class="Section_Title">White-list file</div><div id="ww3_17_14_19_14_3_14_4" class="Body">The white-list file is a simple text file. You can choose any name for this file, for example <span class="filepath">white-list.txt</span>. The entries can be raw IP addresses in IPv4 format or in CIDR notation to represent ranges. IPv6 entries are not supported. Each line in the file can contain either a single IP address or a comma-separated set of IP addresses. Any entry that is not a valid IPv4 address or a valid CIDR will be ignored. Lines starting with a # are skipped. Blank lines are also skipped . Here is a sample white-list file:</div><div id="ww3_17_14_19_14_3_14_6" class="Preformatted"># The white-list for my cluster<br><br># Caching clients<br>192.168.5.28, 192.168.5.29, 192.168.5.30<br>10.60.98.0/28<br><br># Other clients<br>192.168.10.0/24</div><div id="ww3_17_14_19_14_3_14_8" class="Body">The white-list file must be kept in a directory where you have write permissions. Some files will be created by the server in the same directory for book-keeping purposes. If the server fails to create these files, the server startup will also fail.</div><div id="ww3_17_14_19_14_3_16_2" class="Section_Title">Dynamic updates</div><div id="ww3_17_14_19_14_3_16_4" class="Body">Once a server is started with white-listing enabled, entries can be dynamically added/removed from the white-list file. The updates to the white-list file are processed by the server only when you signal the server to do so. When you have finished making the changes to the white-list file, you must execute the "update-white-list.sh" script packaged with the kit. The script takes the white-list file path as the argument. After you run the script the updates will take effect in a few moments and the corresponding log statements can be found in the server log.</div><div id="ww3_17_14_19_14_3_16_6" class="Body">As already mentioned, every server node (active and passive) has its own copy of the white-list file. So you need to update the white-list file and execute the script on each node separately. When you run the script, the server receives the update signal and reloads the white-list file, and the updated white-list entries are logged in the server log. Thus, after every update operation, you should check the server logs to verify if the updates took effect. Make sure that the updates took effect in all the servers in the cluster.</div><div id="ww3_17_14_19_14_3_16_8" class="Body">On every dynamic update, the server reads the contents of the white-list file and the tc-config to update its in-memory white-list. Reading the white-list file involves a disk IO, and reading a tc-config file with hostnames in it involves DNS lookup for hostname resolution. In both cases, failures are very well possible. So if such a failure happens after a dynamic update, the updates will be ignored and the server will continue with the current white-list. No partial updates will be applied. The update won't be retried either until the user signals so by running the update-white-list script again.</div><div id="ww3_17_14_19_14_3_18_2" class="Section_Title">Client behaviors</div><div id="ww3_17_14_19_14_3_18_4" class="Body">This section details different client behaviors with white-listing enabled.</div><div id="ww3_17_14_19_14_3_18_5" class="Section_Division">Caching clients</div><div id="ww3_17_14_19_14_3_18_5_2" class="Body">When a client connects to a server on the tsa-port, the server first accepts the socket connection, then verifies if the IP of the incoming client is white-listed and closes the socket connection if the client is not white-listed. In this case, the client will get an EOF on trying to read from the socket connection established with the server. If a client was white-listed initially and was removed from the white-list on a dynamic update, it will not be removed immediately from the cluster. Instead, the client will remain connected to the cluster as long as there is no network disconnection between the client and server. The client will be rejected only on the next reconnect attempt.</div><div id="ww3_17_14_19_14_3_18_6" class="Section_Division">HTTP clients</div><div id="ww3_17_14_19_14_3_18_6_2" class="Body">Non-white-listed clients that send HTTP requests to the management port will get a 403 Forbidden response.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>