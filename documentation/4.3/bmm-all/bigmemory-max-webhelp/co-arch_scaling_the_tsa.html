<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Scaling the Terracotta Server Array</title><link rel="Prev" href="co-arch_cluster_failover_tuning.html" title="Previous"><link rel="Next" href="to-cfg_configuring_the_tsa.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-arch_scaling_the_tsa.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pod6YUq02J2DNggQyziyIeg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-arch_scaling_the_tsa.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_product_documentation.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_bigmemory_max_admin_guide.html#wwconnect_header">BigMemory Max Administrator Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-arch_architecture.html#wwconnect_header">Terracotta Server Array Architecture</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Scaling the Terracotta Server Array</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_17_12_9_16_1" class="Heading_3">Scaling the Terracotta Server Array</div><div id="ww3_17_12_9_16_3_2" class="Body"><span class="inlinetitle">Persistence: Yes | Failover: Yes | Scale: Yes</span></div><div id="ww3_17_12_9_16_3_4" class="Body">For capacity requirements that exceed the capabilities of a two-server active-mirror setup, expand the Terracotta cluster using a mirror-groups configuration. Using mirror groups with multiple coordinated active Terracotta server instances adds scalability to the Terracotta Server Array.</div><img class="Default" src="../bigmemory-max-webhelp/images/server_array_mirror_group.png" style="display: inline; float: none" alt=""><div id="ww3_17_12_9_16_3_8" class="Body">Mirror groups are specified in the <span class="codeph">&lt;servers&gt;</span> section of the Terracotta configuration file. Mirror groups work by assigning group memberships to Terracotta server instances. The following snippet from a Terracotta configuration file shows a mirror-group configuration with four servers:</div><div id="ww3_17_12_9_16_3_10" class="Preformatted">... <br>&lt;servers&gt; <br>  &lt;mirror-group election-time="10" group-name="groupA"&gt; <br>    &lt;server name="server1"&gt; <br>    ... <br>    &lt;/server&gt; <br>    &lt;server name="server2"&gt; <br>    ... <br>    &lt;/server&gt; <br>  &lt;/mirror-group&gt;      <br>  &lt;mirror-group election-time="15" group-name="groupB"&gt; <br>    &lt;server name="server3"&gt; <br>    ... <br>    &lt;/server&gt; <br>    &lt;server name="server4"&gt; <br>    ... <br>    &lt;/server&gt; <br>  &lt;/mirror-group&gt;      <br>  &lt;restartable enabled="true"/&gt; <br>&lt;/servers&gt; <br>...</div><div id="ww3_17_12_9_16_3_12" class="Body">In this example, the cluster is configured to have two active servers, each with its own mirror. If server1 is elected active in groupA, server2 becomes its mirror. If server3 is elected active in groupB, server4 becomes its mirror. server1 and server3 automatically coordinate their work managing Terracotta clients and shared data across the cluster.</div><div id="ww3_17_12_9_16_3_14" class="Body">In a Terracotta cluster designed for multiple active Terracotta server instances, the server instances in each mirror group participate in an election to choose the active. Once every mirror group has elected an active server instance, all the active server instances in the cluster begin cooperatively managing the cluster. The rest of the server instances become mirrors for the active server instance in their mirror group. If the active in a mirror group fails, a new election takes place to determine that mirror group's new active. Clients continue work without regard to the failure.</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_12_9_16_3_16_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_12_9_16_3_16_1_3_1_2" class="Table_Cell">Server vs. Mirror Group - Under <span class="codeph">&lt;servers&gt;</span>, you may use either <span class="codeph">&lt;server&gt;</span> or <span class="codeph">&lt;mirror-group&gt;</span> configurations, but not both. All <span class="codeph">&lt;server&gt;</span> configurations directly under <span class="codeph">&lt;servers&gt;</span> work together as one mirror group, with one active server and the rest mirrors. To create more than one stripe, use <span class="codeph">&lt;mirror-group&gt;</span> configurations directly under <span class="codeph">&lt;servers&gt;</span>. The mirror group configurations then include one or more <span class="codeph">&lt;server&gt;</span> configurations.</div></td></tr></table></div><div id="ww3_17_12_9_16_3_18" class="Body">In a Terracotta cluster with mirror groups, each group, or "stripe", behaves in a similar way to an active-mirror setup (see <span class="local"><a href="../bigmemory-max-webhelp/co-arch_cluster_with_ha.html#wwconnect_header" title="Terracotta Cluster with High Availability">Terracotta Cluster with High Availability </a></span>. For example, when a server instance is started in a stripe while an active server instance is present, it synchronizes state from the active server instance before becoming a mirror. A mirror cannot become an active server instance during a failure until it is fully synchronized. If an active server instance running in restartable mode goes down, and a mirror takes over, the data directory is cleared before bringing back the crashed server.</div><div id="ww3_17_12_9_16_3_20_2" class="Section_Title">Election Time</div><div id="ww3_17_12_9_16_3_20_4" class="Body">The <span class="codeph">&lt;mirror-group&gt;</span> configuration allows you to declare the election time window. An active server is elected from the servers that cast a vote within this window. The value is specified in seconds and the default is 5 seconds. Network latency and the work load of the servers should be taken into consideration when choosing an appropriate window.</div><div id="ww3_17_12_9_16_3_20_6" class="Body">In the above example, the servers in groupA can take up to 10 seconds to elect an active server, and the servers in groupB can take up to 15 seconds.</div><div id="ww3_17_12_9_16_3_22_2" class="Section_Title">Stripe and Cluster Failure</div><div id="ww3_17_12_9_16_3_22_4" class="Body">If the active server in a mirror group fails or is taken down, the cluster stops until a mirror takes over and becomes active (ACTIVE-COORDINATOR status).</div><div id="ww3_17_12_9_16_3_22_6" class="Body">However, the cluster cannot survive the loss of an entire stripe. If an entire stripe fails and no server in the failed mirror-group becomes active within the allowed window (based on the election-time setting), the entire cluster must be restarted.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>