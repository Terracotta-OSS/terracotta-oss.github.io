<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Basic Connection Security</title><link rel="Prev" href="co-sec_default_security.html" title="Previous"><link rel="Next" href="ta-sec_adding_ssl.html" title="Next"><link rel="StyleSheet" href="css/aaa_bigmem_max_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/aaa_bigmem_max_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/bigmemory-max-webhelp/co-sec_basic_connection_security.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN1WEcPX92K4IF_002fKu58mC3kQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/bigmemory-max-webhelp/co-sec_basic_connection_security.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_product_documentation.html#wwconnect_header">Product Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-title_tcm_user_guide.html#wwconnect_header">Terracotta Management Console User Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_parent"><a href="../bigmemory-max-webhelp/to-sec_setting_up_security.html#wwconnect_header">Setting up Security</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Basic Connection Security</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_17_18_21_12_1" class="Heading_3">Basic Connection Security</div><div id="ww3_17_18_21_12_3_2" class="Body">You can secure the connections between the TMS and managed agents using a built-in hash-based message authentication scheme and digital certificates, also known as "identity assertion" (IA). Use this level of security in environments where the TMS might be exposed to unwanted connection attempts from rogue agents, or where managed agents might come under attack from a rogue TMS.</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_4_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_4_1_3_1_2" class="Table_Cell">To fully secure connections between the TMS and managed agents, it is recommended that SSL be used for encryption. For information about adding SSL to a connection, see <span class="heading-page"><a href="../bigmemory-max-webhelp/ta-sec_adding_ssl.html#wwconnect_header" title="Adding SSL">Adding SSL</a></span>.</div></td></tr></table></div><div id="ww3_17_18_21_12_3_6" class="Body">To set up identity assertion, complete the following steps:</div><div id="ww3_17_18_21_12_3_8_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Set up a truststore as described in <span class="heading-page"><a href="../bigmemory-max-webhelp/co-sec_basic_connection_security.html#ww3_17_18_21_12_3_10_2" title="Basic Connection Security">Setting Up a Truststore</a></span>.</div><div id="ww3_17_18_21_12_3_8_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Configure identity assertion as described in <span class="heading-page"><a href="../bigmemory-max-webhelp/co-sec_basic_connection_security.html#ww3_17_18_21_12_3_12_2" title="Basic Connection Security">Configuring Identity Assertion</a></span>.</div><div id="ww3_17_18_21_12_3_8_6" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>Create a shared secret for the TMS and the managed agents as described in <span class="heading-page"><a href="../bigmemory-max-webhelp/co-sec_basic_connection_security.html#ww3_17_18_21_12_3_14_2" title="Basic Connection Security">Creating a Shared Secret</a></span>.</div><div id="ww3_17_18_21_12_3_10_2" class="Section_Title">Setting Up a Truststore</div><div id="ww3_17_18_21_12_3_10_4" class="Body">The TMS must have a truststore containing the public-key certificate of every agent that connects to it. If you are not using a Certificate Authority (which provides the public keys), export public keys from the self-signed certificates in the keystore of each agent using a command similar to the following:</div><div id="ww3_17_18_21_12_3_10_6" class="Preformatted">keytool -export -alias myAgent -keystore keystore-file.jks \ <br>    -file myAgentCert.cert</div><div id="ww3_17_18_21_12_3_10_8" class="Body">Then import the keys into the TMS truststore, creating it as shown (if it does not already exist):</div><div id="ww3_17_18_21_12_3_10_10" class="Preformatted">keytool -import -alias myAgent -file myAgentCert.cert \ <br>    -keystore truststore.jks</div><div id="ww3_17_18_21_12_3_10_12" class="Body">When you use the <span class="filepath">keytool</span> utility, you can maintain additional certificates for the chain of trust in a file <span class="filepath">cacerts</span>. If you wish to use these additional certificates for the import, refer to the use of the option <span class="codeph">-trustcacerts</span> in the documentation of the <span class="filepath">keytool</span> utility.</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_10_14_1_3_1_1_1" class="tip"><span style="font-weight: bold">Tip:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_10_14_1_3_1_2" class="Table_Cell">As an alternative to using the command line tool <span class="Citation">keytool</span>, you might want to try the open source graphical tool <span class="Citation">KeyStore Explorer</span>, available at <span class="external"><a href="http://www.keystore-explorer.org/index.html" target="external_window">http://www.keystore-explorer.org/index.html</a></span>.</div></td></tr></table></div><div id="ww3_17_18_21_12_3_10_16" class="Body">If a managed agent does not have a keystore, set one up. For examples, see the <span class="Citation">BigMemory Max Security Guide</span>. </div><div id="ww3_17_18_21_12_3_10_18" class="Body">Make your truststore available to the TMS in one of the following ways:</div><div id="ww3_17_18_21_12_3_10_20_2" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span><span class="codeph">${user.home}/.tc/mgmt/tms-truststore</span></div><div id="ww3_17_18_21_12_3_10_20_4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="bullet.gif" alt="*" border="0" width="10" height="10"></span></span>a location configured with the system property <span class="codeph">javax.net.ssl.trustStore</span></div><div id="ww3_17_18_21_12_3_10_22" class="Body">Alternatively, you can import these public keys into the default truststore for the JVM (typically the cacerts file).</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_10_24_1_3_1_1_1" class="Note"><span style="font-weight: bold">Note:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_17_18_21_12_3_10_24_1_3_1_2" class="Table_Cell">If a different default location for TMS-related files is required, set it using the system property <span class="codeph">com.tc.management.config.directory</span>.</div></td></tr></table></div><div id="ww3_17_18_21_12_3_12_2" class="Section_Title">Configuring Identity Assertion</div><div id="ww3_17_18_21_12_3_12_4" class="Body">To configure identity assertion (IA) for the Terracotta Server Array, see the <span class="Citation">BigMemory Max Security Guide</span>.</div><div id="ww3_17_18_21_12_3_12_6" class="Body">To configure IA on a Terracotta client, enable security (authentication by IA) on the REST service by adding the <span class="parmname">securityServiceLocation</span> attribute to the managementRESTService element in the managed agent's configuration. The following example is for Ehcache:</div><div id="ww3_17_18_21_12_3_12_8" class="Preformatted">    &lt;ehcache ...&gt; <br>    ...  <br>      &lt;managementRESTService enabled="true" <br>      securityServiceLocation="http://localhost:9889/tmc/api/assertIdentity"  /&gt; <br>    ... <br>    &lt;/ehcache&gt;</div><div id="ww3_17_18_21_12_3_12_10" class="Body">If <span class="codeph">securityServiceLocation</span> is not set, the authentication feature is disabled. To enable it, set its value to the URI used to connect to the TMC, with <span class="codeph">/tmc/api/assertIdentity</span> appended. In the example above, "http://localhost:9889" is the TMC URI.</div><div id="ww3_17_18_21_12_3_12_12" class="Body">For BigMemory Go, use the same procedure as for a Terracotta client.</div><div id="ww3_17_18_21_12_3_14_2" class="Section_Title">Creating a Shared Secret</div><div id="ww3_17_18_21_12_3_14_4" class="Body">You must create a password (or secret) that is shared between the TMS and managed agents, storing it in a Terracotta keychain file.</div><div id="ww3_17_18_21_12_3_14_6" class="Body">The scripts required in the following procedures are found in <span class="filepath">${BIGMEMORY_GO_HOME}/management-console/bin</span> or <span class="filepath">${BIGMEMORY_MAX_HOME}/tools/management-console/bin</span>. Use the equivalent .bat scripts for Microsoft Windows.</div><div id="ww3_17_18_21_12_3_16_2" class="Section_Title">Shared Secret on the TMS</div><div id="ww3_17_18_21_12_3_16_4_2_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Create a shared secret for the assertion of trust between the TMS and managed agents by running the following script:</div><div id="ww3_17_18_21_12_3_16_4_2_5" class="Preformatted_1">./add-tc-agent.sh &lt;agent-url&gt;</div><div id="ww3_17_18_21_12_3_16_4_2_7" class="Numbered_1_Continued">where <span class="codeph">&lt;agent-url&gt;</span> is the URI of the agent. This value should correspond exactly to the URI you use in the TMC to connect to the given agent. For example:</div><div id="ww3_17_18_21_12_3_16_4_2_9" class="Preformatted_1">./add-tc-agent.sh http://localhost:9888</div><div id="ww3_17_18_21_12_3_16_4_2_11" class="Numbered_1_Continued">Use <span class="codeph">add-tc-agent.bat</span> with Microsoft Windows.</div><div id="ww3_17_18_21_12_3_16_4_2_13" class="Numbered_1_Continued">The script automatically creates the Terracotta keychain file <span class="codeph">&lt;user_home&gt;/.tc/mgmt/keychain</span> if it does not already exist. Do not move or delete this keychain file because it must remain accessible to the TMS at that location.</div><div id="ww3_17_18_21_12_3_16_4_4_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>When prompted, enter a shared secret of your choice. Be sure to remember the secret that you enter because you might need to enter it again in a later step. </div><div id="ww3_17_18_21_12_3_16_4_6_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Run the add-tc-agent script once for each agent, using that agent's URI. The script saves these entries to the same keychain file.</div><div id="ww3_17_18_21_12_3_18_2" class="Section_Title">Shared Secret on Managed Agents</div><div id="ww3_17_18_21_12_3_18_4_2_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Each agent with a keychain entry must also have access to the same shared secret through a Terracotta keychain file:</div><div id="ww3_17_18_21_12_3_18_4_2_5" class="Preformatted_1">./keychain.sh -c &lt;user_home&gt;/.tc/mgmt/agentKeychainFile \ <br>    http://myHost:9889/tc-management-api</div><div id="ww3_17_18_21_12_3_18_4_2_7" class="Numbered_1_Continued">where <span class="codeph">&lt;tmc-url&gt;</span> is the URI used to connect to the TMC, with <span class="codeph">/tc-management-api</span> appended. If the named keychain file already exists on the node, omit the <span class="codeph">-c</span> flag. Agents running on the same node can share a keychain file.</div><div id="ww3_17_18_21_12_3_18_4_4_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Enter the master key for the keychain file:</div><div id="ww3_17_18_21_12_3_18_4_4_5" class="Preformatted_1">Terracotta Management Console - Keychain Client <br>KeyChain file successfully created in /path/to/agentKeychainFile <br>Open the keychain by entering its master key:</div><div id="ww3_17_18_21_12_3_18_4_6_3" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Enter the shared secret associated with the TMS:</div><div id="ww3_17_18_21_12_3_18_4_6_5" class="Preformatted_1">Enter the password you wish to associate with this URL: <br>Password for http://myHost:9889/ successfully stored</div><div id="ww3_17_18_21_12_3_18_4_6_7" class="Numbered_1_Continued">The secret you enter must match the one entered for the TMS. Note that the script's success acknowledgment does <span class="emphasis">not</span> confirm that the secret matches the one stored on the TMS.</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright © <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/terracotta_online.png" alt="Product Logo"><a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank">Contact&nbsp;Support</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank">Community</a>
         &nbsp;&nbsp;|&nbsp;&nbsp;
       <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>