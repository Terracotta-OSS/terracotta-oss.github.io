<!DOCTYPE html ><html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Cluster Configuration</title><link rel="Prev" href="re-data_custom_connection_provider_implementations.html" title="Previous"><link rel="Next" href="re-tcjs_terracottajobstore_configuration.html" title="Next"><link rel="StyleSheet" href="css/_qs_all.css" type="text/css" media="all"><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all"><link rel="StyleSheet" href="css/social.css" type="text/css" media="all"><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all"><!--[if IE 7]><link rel="StyleSheet" href="css/_qs_all_IE7.css" type="text/css" media="all"><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print"><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if (window === window.top) {
        // Redirect
        //
        redirect_url = "../index.html#page/quartz-scheduler-webhelp/re-cls_cluster_configuration.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pxh997hj7KjplM7buOTkTog" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/quartz-scheduler-webhelp/re-cls_cluster_configuration.html');"><header id="wwconnect_header"><div class="ww_skin_breadcrumbs"><span class="ww_skin_breadcrumbs_parent"><a href="../quartz-scheduler-webhelp/_qs_all.1.041.html#wwconnect_header">Quartz Scheduler Configuration Guide</a></span><span class="ww_skin_breadcrumbs_divider"> : </span><span class="ww_skin_breadcrumbs_current">Cluster Configuration</span></div><div class="ww_skin_page_toolbar"></div></header><div id="ww3_10_23_1" class="Heading_1">Cluster Configuration</div><div id="ww3_10_23_3_2_2" class="Body">Quartz's clustering features bring both high availability and scalability to your scheduler via fail-over and load balancing functionality.</div><div class="ww_skin_page_overflow"><div id="ww3_10_23_3_2-2" class="Section"><img class="Default" src="../quartz-scheduler-webhelp/images/fig_quartz_cluster.png" width="309" height="174" style="display: inline; float: none; left: 0pt; top: 0pt" alt=""></div></div><div id="ww3_10_23_3_2_6" class="Body">Clustering currently only works with the JDBC-Jobstore (JobStoreTX or JobStoreCMT), and essentially works by having each node of the cluster share the same database. </div><div id="ww3_10_23_3_2_8" class="Body">Load-balancing occurs automatically, with each node of the cluster firing jobs as quickly as it can. When a trigger's firing time occurs, the first node to acquire it (by placing a lock on it) is the node that will fire it.</div><div id="ww3_10_23_3_2_10" class="Body">Only one node will fire the job for each firing. Meaning that, if the job has a repeating trigger that is set to fire every 10 seconds, then at 12:00:00 exactly one node will run the job, and at 12:00:10 exactly one node will run the job, and so forth. It won't necessarily be the same node each time. The selected node is chosen more or less at random. The load balancing mechanism is near-random for busy schedulers (lots of triggers) but favors the same node for non-busy (few triggers) schedulers.</div><div id="ww3_10_23_3_2_12" class="Body">Fail-over occurs when one of the nodes fails while in the midst of executing one or more jobs. When a node fails, the other nodes detect the condition and identify the jobs in the database that were in progress within the failed node. Any jobs marked for recovery (with the "requests" property on the JobDetail) will be re-executed by the remaining nodes. Jobs not marked for recovery will simply be freed up for execution at the next time a related trigger fires.</div><div id="ww3_10_23_3_2_14" class="Body">The clustering feature works best for scaling out long-running and/or CPU-intensive jobs (i.e., distributing the work-load over multiple nodes). If you need to scale out to support thousands of short-running (e.g., one second) jobs, consider partitioning the set of jobs by using multiple distinct schedulers (including multiple clustered schedulers for HA). The scheduler makes use of a cluster-wide lock, a pattern that degrades performance as you add more nodes (when going beyond about three nodes - depending upon your database's capabilities, etc.).</div><div id="ww3_10_23_3_2_16" class="Body">Enable clustering by setting the <span class="parmname">org.quartz.jobStore.isClustered</span> property to true. Each instance in the cluster should use the same copy of the quartz.properties file. Exceptions of this would be to use properties files that are identical, with the following allowable exceptions: different thread pool size, and different value for the <span class="parmname">org.quartz.scheduler.instanceId</span> property. Each node in the cluster <span class="emphasis">must</span> have a unique instanceId, which is easily done (without needing different properties files) by placing AUTO as the value of this property. For more information, see the configuration properties in .</div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_10_23_3_2_18_1_3_1_1_1" class="important"><span style="font-weight: bold">Important:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_10_23_3_2_18_1_3_1_2" class="Table_Cell">Never run clustering on separate machines, unless their clocks are synchronized using some form of time-sync service (daemon) that runs very regularly (the clocks must be within a second of each other). See <span class="external"><a href="http://www.boulder.nist.gov/timefreq/service/its.htm" target="external_window">http://www.boulder.nist.gov/timefreq/service/its.htm</a></span> if you are unfamiliar with how to do this.</div></td></tr></table></div><div class="ww_skin_page_overflow"><table class="note1" summary=""><tr><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_10_23_3_2_20_1_3_1_1_1" class="important"><span style="font-weight: bold">Important:  </span>&nbsp;</div></td><td class="Table_Cell" style="padding-right: 6px; vertical-align: top"><div id="ww3_10_23_3_2_20_1_3_1_2" class="Table_Cell">Never start (scheduler.start()) a non-clustered instance against the same set of database tables that any other instance is running (start()ed) against. Doing so will result in data corruption and erratic behavior.</div></td></tr></table></div><div id="ww3_10_23_3_4_2" class="Section_Title">Example Properties For A Clustered Scheduler</div><div id="ww3_10_23_3_4_4" class="Preformatted">#============================================================================     <br># Configure Main Scheduler Properties       <br>#============================================================================     <br>org.quartz.scheduler.instanceName = MyClusteredScheduler     <br>org.quartz.scheduler.instanceId = AUTO     <br>#============================================================================     <br># Configure ThreadPool       <br>#============================================================================     <br>org.quartz.threadPool.class = org.quartz.simpl.SimpleThreadPool     <br>org.quartz.threadPool.threadCount = 25     <br>org.quartz.threadPool.threadPriority = 5     <br>#============================================================================     <br># Configure JobStore       <br>#============================================================================     <br>org.quartz.jobStore.misfireThreshold = 60000     <br>org.quartz.jobStore.class = org.quartz.impl.jdbcjobstore.JobStoreTX     <br>org.quartz.jobStore.driverDelegateClass =</div><div id="ww3_10_23_3_4_6" class="Preformatted">org.quartz.impl.jdbcjobstore.oracle.OracleDelegate     <br>org.quartz.jobStore.useProperties = false</div><div id="ww3_10_23_3_4_8" class="Preformatted">org.quartz.jobStore.dataSource = myDS     <br>org.quartz.jobStore.tablePrefix = QRTZ _   <br>org.quartz.jobStore.isClustered = true</div><div id="ww3_10_23_3_4_10" class="Preformatted">org.quartz.jobStore.clusterCheckinInterval = 20000     <br>#============================================================================     <br># Configure Datasources       <br>#============================================================================     <br>org.quartz.dataSource.myDS.driver = oracle.jdbc.driver.OracleDriver     <br>org.quartz.dataSource.myDS.URL = jdbc:oracle:thin:@polarbear:1521:dev     <br>org.quartz.dataSource.myDS.user = quartz     <br>org.quartz.dataSource.myDS.password = quartz     <br>org.quartz.dataSource.myDS.maxConnections = 5     <br>org.quartz.dataSource.myDS.validationQuery=select 0 from dual</div><footer><!-- Related Topics --><!--                --><!-- Back to Top --><!--             --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br></footer><div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 11px; margin-top: 20px; margin-bottom: 20px;"><span class="xref"><a href="http://documentation.softwareag.com/legal/" target="external_window">Copyright Â© <span>2010</span><span>-2016</span><span></span><span></span> Software AG, Darmstadt, Germany</a></span>.</div><hr></div><div style="font-family: Arial, Verdana, Helvetica, Sans-Serif; font-size: 13px; font-weight: bold; margin-top: 20px;"><span><img style="vertical-align:middle" src="../connect/quartz_online.png" alt="Product Logo"><!--	     <a href="https://empower.softwareag.com/ContactSupport/default.asp" target="_blank" >Contact&#160;Support</a> --><!--         &#160;&#160;|&#160;&#160;  --><!--         <a href="http://www.softwareag.com/corporate/community/default.asp" target="_blank" >Community</a>  --><!--         &#160;&#160;  -->
          |&nbsp;&nbsp;
        <a href="mailto://documentation@softwareag.com" target="_blank">Feedback&nbsp;&nbsp;</a></span></div></body></html>